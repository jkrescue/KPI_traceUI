# 指标定义与权衡分析 - 交互式工作流程指南

## 概述

全新的三步交互式工作流程，让用户可以自定义指标维度、智能拆解指标和对比多方案，实现个性化的指标权衡分析。

---

## 📋 完整工作流程

### **步骤1：定义指标维度** 🎯

#### 功能特性
- **5个顶层指标维度**
  - 成本（默认20%）
  - 轻量化（默认15%）
  - 安全（默认25%）
  - 空间（默认20%）
  - 性能（默认20%）

#### 交互操作
1. **查看默认权重**
   - 每个维度卡片显示名称、描述和当前权重百分比
   - 初始状态显示系统默认权重配置

2. **编辑权重**
   - 点击任意卡片的编辑按钮（✏️）激活编辑模式
   - 拖动滑块调整权重值（0%-100%，步长5%）
   - 实时显示权重百分比变化

3. **权重管理**
   - **归一化权重**：一键调整所有权重使总和=100%
   - **重置默认值**：恢复系统预设权重配置
   - 底部提示框实时显示权重总和及建议

4. **完成配置**
   - 点击"下一步：指标拆解"进入步骤2
   - 自定义权重将影响后续的拆解建议和方案推荐

---

### **步骤2：指标拆解分析** 🌳

#### 功能特性
基于步骤1设置的权重，系统自动生成智能化指标拆解建议。

#### 优先级分析面板
自动将5个维度按权重分为三档：

1. **🔥 高优先级**（权重最高的2个维度）
   - 红色渐变卡片
   - 显示维度名称和权重百分比
   - 标记为重点关注对象

2. **⚡ 中优先级**（权重中等的2个维度）
   - 黄色渐变卡片
   - 需要适度关注

3. **💡 低优先级**（权重最低的1个维度）
   - 蓝色渐变卡片
   - 可以适当降低资源投入

#### 智能拆解建议
- **针对高优先级维度**：
  - 显示相关联的一级KPI指标
  - 提供"建议重点关注以下KPI"的具体清单
  - 例如：安全（25%）→ 建议关注：锁止安全性

#### 完整指标拆解映射
显示6个一级KPI指标的完整映射关系：

| KPI | 映射的顶层指标 | 视觉标识 |
|-----|---------------|----------|
| 折叠时间 | 性能、成本 | 根据重要性着色 |
| 折叠角度 | 性能、空间、轻量化 | - |
| 乘员空间提升 | 空间 | - |
| 锁止安全性 | 安全 | - |
| NVH性能 | 性能 | - |
| 折叠寿命 | 性能、成本 | - |

**动态高亮规则**：
- 🔴 红色背景：KPI重要性 > 30%（关联高权重维度）- 标记"重点"
- 🟡 黄色背景：KPI重要性 15%-30%
- ⚪ 灰色背景：KPI重要性 < 15%

#### 操作
- 点击"上一步：调整权重"返回步骤1修改配置
- 点击"下一步：多方案权衡"进入步骤3

---

### **步骤3：多方案权衡** ⚡

#### 功能特性
默认提供3个设计方案，基于用户权重配置智能推荐最优方案。

#### 智能推荐系统
- **启用条件**：用户在步骤1中修改过权重
- **推荐算法**：
  ```
  加权得分 = Σ(方案在各维度的得分 × 维度权重)
  推荐方案 = 加权得分最高的方案
  ```
- **推荐提示**：
  - 顶部紫粉渐变卡片显示推荐信息
  - 显示推荐方案名称和加权得分
  - 方案卡片标记"智能推荐"徽章

#### 三组设计方案

##### 方案A：性能优先
- **技术特点**：高性能电机 + 铝合金材料 + 精密传感器
- **五维评分**：
  - 成本：45分 ⚠️
  - 轻量化：85分 ✅
  - 安全：95分 ✅
  - 空间：90分 ✅
  - 性能：98分 ⭐
- **加权得分示例**（默认权重）：83.4分
- **适用场景**：高端车型，追求极致体验

##### 方案B：平衡方案 ⭐（系统默认推荐）
- **技术特点**：钢铝混合材料 + 标准电机 + 标准传感器
- **五维评分**：
  - 成本：75分 ✅
  - 轻量化：70分 ✅
  - 安全：90分 ✅
  - 空间：85分 ✅
  - 性能：88分 ✅
- **加权得分示例**（默认权重）：82.25分
- **适用场景**：主流车型，均衡表现

##### 方案C：成本优先
- **技术特点**：钢材 + 标准电机 + 基础传感器
- **五维评分**：
  - 成本：92分 ⭐
  - 轻量化：55分 ⚠️
  - 安全：85分 ✅
  - 空间：75分 ✅
  - 性能：75分 ✅
- **加权得分示例**（默认权重）：75.55分
- **适用场景**：经济型车型，成本敏感市场

#### 可视化对比
- **雷达图**：
  - 五维度直观对比
  - 三条曲线：方案A（红）、方案B（紫）、方案C（绿）
  - 支持Tooltip交互查看具体数值

- **方案卡片**：
  - 点击选择方案（单选）
  - 显示方案描述和五维评分
  - 自定义权重模式下显示加权得分
  - 推荐方案显示特殊徽章

#### 选定方案KPI预览
显示选定方案的6个一级KPI指标详情：
- 指标名称
- 目标值（如"1.4 s"、"0-120°"）
- 达成率进度条（绿色≥90%，黄色70-90%，红色<70%）
- 达成率百分比

#### 操作
- 点击"上一步：查看拆解"返回步骤2
- 点击"进入指标评估"进入主可视化界面

---

## 🎨 步骤导航器

### 特性
- **可视化进度**：顶部显示3个步骤卡片
- **状态标识**：
  - ⚪ 未完成：灰色边框，图标灰色
  - 🟣 进行中：紫色边框，紫色图标，阴影效果
  - 🟢 已完成：绿色边框，绿色打勾图标

- **交互方式**：
  - 点击已完成或当前步骤可切换
  - 未完成步骤不可点击

- **步骤图标**：
  - 步骤1：⚙️ 设置图标
  - 步骤2：🌳 分支图标
  - 步骤3：⚡ 闪电图标

---

## 💡 使用场景示例

### 场景1：成本敏感项目
1. **步骤1**：将"成本"权重调至35%，"性能"降至15%
2. **步骤2**：系统标记折叠寿命为高优先级KPI
3. **步骤3**：智能推荐"方案C：成本优先"，加权得分最高

### 场景2：高端车型项目
1. **步骤1**：将"性能"权重调至30%，"安全"调至30%
2. **步骤2**：折叠时间、锁止安全性标记为重点
3. **步骤3**：智能推荐"方案A：性能优先"

### 场景3：使用默认配置
1. **步骤1**：不修改权重，直接进入下一步
2. **步骤2**：查看默认优先级分布
3. **步骤3**：选择系统推荐的"方案B：平衡方案"

---

## 🔄 数据流转

```
步骤1 自定义权重
    ↓
    权重数据传递
    ↓
步骤2 指标拆解
    • 优先级自动分类
    • KPI重要性计算
    • 智能建议生成
    ↓
    权重数据传递
    ↓
步骤3 方案对比
    • 加权得分计算
    • 智能推荐生成
    • 方案选择
    ↓
    选定方案数据传递
    ↓
主评估界面
    • KPI值同步更新
    • 显示方案信息
```

---

## 🎯 核心优势

### 1. 个性化配置
- 用户可根据项目特点自定义权重
- 不同权重配置产生不同的推荐结果

### 2. 智能化建议
- 自动分析优先级
- 动态生成拆解建议
- 基于权重计算推荐方案

### 3. 可视化交互
- 雷达图直观对比
- 进度条显示达成率
- 颜色编码优先级

### 4. 灵活性
- 支持前后切换修改
- 保留用户配置状态
- 可随时返回调整

---

## 📊 数据同步机制

### 从前置页面到主界面
```typescript
interface DesignScheme {
  id: string;
  name: string;
  kpiValues: {
    [kpiId: string]: {
      achievementRate: number;  // 同步到主界面节点
      value: string;            // 显示值
    };
  };
}
```

### 同步规则
- 一级KPI节点的 `achievementRate` 更新
- `achieved` 状态根据达成率计算（≥90%为true）
- 主界面Header显示当前选定方案名称和推荐标识

---

## 🚀 扩展建议

### 功能增强
1. **自定义KPI目标值**：允许用户修改每个KPI的目标阈值
2. **方案对比表**：生成横向对比表格，便于打印和分享
3. **保存配置**：支持保存权重配置和方案选择
4. **导出报告**：一键生成PDF分析报告
5. **敏感性分析**：展示权重变化对推荐结果的影响

### 方案扩展
1. **自定义方案**：允许用户创建新方案并设置评分
2. **方案数量**：支持超过3个方案的对比
3. **方案历史**：记录用户评估过的所有方案

---

## 📝 注意事项

1. **权重归一化**
   - 系统不强制权重总和为100%
   - 但建议使用"归一化权重"按钮确保准确性

2. **智能推荐触发**
   - 只有修改过权重才显示智能推荐
   - 使用默认权重时显示系统预设推荐

3. **步骤依赖**
   - 步骤2的分析依赖步骤1的权重配置
   - 步骤3的推荐依赖步骤1的权重配置
   - 建议按顺序完成，但可回退修改

4. **方案选择**
   - 智能推荐仅供参考，用户可选择任意方案
   - 推荐算法基于加权得分，不考虑其他因素

---

## 🎓 最佳实践

### 权重设置建议
- **明确项目目标**：成本、性能、安全等哪个最重要？
- **参考行业标准**：不同车型定位有不同权重分布
- **团队共识**：与团队讨论确定权重配置
- **适度调整**：权重不宜过于极端，保持一定均衡

### 方案选择建议
- **查看加权得分**：但不唯一依据
- **分析维度短板**：注意低分维度的影响
- **结合KPI预览**：关注具体指标达成情况
- **考虑实际约束**：成本、时间、技术成熟度等

### 工作流程建议
1. 第一次：使用默认权重快速体验
2. 第二次：基于项目特点调整权重
3. 对比多次：尝试不同权重配置看推荐变化
4. 最终确定：团队评审后确定最终方案

---

## 📞 帮助信息

### 常见问题

**Q: 为什么我修改权重后推荐方案变了？**
A: 智能推荐基于加权得分动态计算，不同权重配置会产生不同的推荐结果。

**Q: 可以跳过步骤直接到步骤3吗？**
A: 可以点击已完成的步骤切换，但建议按顺序完成以获得最佳体验。

**Q: 权重总和不是100%会怎样？**
A: 系统会提示但不会阻止，建议点击"归一化权重"调整。

**Q: 智能推荐和系统推荐有什么区别？**
A: 智能推荐基于用户自定义权重计算，系统推荐是预设的默认推荐（方案B）。

---

## 版本历史

### v2.0 - 2025-11-21
- ✨ 新增三步交互式工作流程
- 🎯 新增权重自定义功能
- 🌳 新增智能指标拆解分析
- ⚡ 新增基于权重的智能推荐
- 🎨 新增步骤导航器
- 📊 优化数据同步机制

### v1.0 - 初始版本
- 基础方案对比功能
- 雷达图可视化
- KPI预览

---

**提示**：本功能旨在辅助决策，最终方案选择应综合考虑项目实际情况和团队专业判断。
